{% load static %}
{% load bootstrap_icons %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SAQ Feeder Data Viewer</title>

  <link rel="stylesheet" href="{% static 'dataapi/css/csv_table.css' %}">
  <link rel="stylesheet" href="{% static 'dataapi/css/bootstrap.min.css' %}">

</head>
<body>
<div class="container mt-5">
  <h2>SAqFeeder Data Viewer</h2>

<!-- Year Selector + Refresh Button Row -->
<div class="d-flex justify-content-between align-items-center mb-4">
  <form method="get" class="form-inline mb-0 d-flex align-items-center">
    <label for="year" class="mr-2 font-weight-bold mb-0">Select Year:</label>
    <select id="year" name="year" class="form-control mr-2" onchange="this.form.submit()">
      {% for y in years %}
        <option value="{{ y }}" {% if y == selected_year %}selected{% endif %}>{{ y }}</option>
      {% endfor %}
    </select>
  </form>

  <button type="button" class="btn btn-primary" onclick="location.reload();">
    <i class="bi bi-arrow-clockwise"></i>
    Refresh
  </button>
</div>



  <!-- Month Tabs -->
  <ul class="nav nav-tabs">
    {% for m, name in months %}
        <li class="nav-item">
            <a class="nav-link {% if m == selected_month %}active{% endif %}"
                href="?year={{ selected_year }}&month={{ m }}">
            {{ name }}
            </a>
        </li>
    {% endfor %}
  </ul>

  <!-- Table Display -->
  <div class="table-responsive mt-4">
    {{ table_html|safe }}
  </div>

  
</div>

<!-- Image Modal -->
<div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="imageModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="imageId">Sensor Image</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center">
        <img id="sensorImage" src="" alt="Sensor Image" class="img-fluid rounded shadow">
      </div>
    </div>
  </div>
</div>


<script src="{% static 'dataapi/js/jquery-3.6.0.min.js' %}"></script>
<script src="{% static 'dataapi/js/jquery.dataTables.min.js' %}"></script>
<script src="{% static 'dataapi/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'dataapi/js/csv_table.js' %}"></script>
<script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>

</body>
</html>
